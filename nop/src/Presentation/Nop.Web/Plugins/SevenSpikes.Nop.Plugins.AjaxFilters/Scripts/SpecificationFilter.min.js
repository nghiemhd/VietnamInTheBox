/*
* Copyright 2013 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { $(".specificationFilterPanel7Spikes .filtersGroupPanel a[data-option-id]").each(function () { var b = new SpecificationFiltersManager; $(this).click(b.filterProductsBySpecificationAttributeOption) }) }); function SpecificationFiltersManager() { } SpecificationFiltersManager.prototype.filterProductsBySpecificationAttributeOption = FilterProductsBySpecificationAttributeOption; SpecificationFiltersManager.prototype.buildSpecificationFiltersModel = BuildSpecificationFiltersModel; SpecificationFiltersManager.prototype.refreshSpecificationFilters = RefreshSpecificationFilters; FiltersManager.prototype.buildSpecificationFiltersModel = (new SpecificationFiltersManager).buildSpecificationFiltersModel; FiltersManager.prototype.refreshSpecificationFilters = (new SpecificationFiltersManager).refreshSpecificationFilters; function BuildSpecificationFiltersModel(b, c, d) { var a = {}; a.CategoryId = b; a.ManufacturerId = c; a.SpecificationFilterGroups = []; $(".specificationFilterPanel7Spikes .filtersGroupPanel").each(function (c, b) { var j = $(b).attr("data-optionsGroupId"), e = {}; e.Id = j; void 0 != d && d.get(0) == b && (e.IsMain = !0, a.Priority = 1); e.FilterItems = []; $(b).find("a[data-option-id]").each(function (b, c) { var a = $(c).attr("data-option-id"), f = $(c).attr("class"), d = {}; d.Id = a; d.FilterItemState = (new FiltersManager).getFilterItemStateBasedOnItemClass(f, d.FilterItemState); e.FilterItems.push(d) }); a.SpecificationFilterGroups.push(e) }); return a } function RefreshSpecificationFilters(b, c) { $(".specificationFilterPanel7Spikes .filtersGroupPanel").each(function (d, a) { var g = $(a).attr("data-optionsGroupId"), h = $.grep(b.SpecificationFilterGroups, function (b) { return b.Id == g }); if (0 != h.length) { var j = h[0]; if (c && "usedropdowns" == c) var e = !0; $(a).find("a[data-option-id]").each(function (b, a) { var d = $(a).attr("data-option-id"), f = $.grep(j.FilterItems, function (a) { return a.Id == d }); 0 != f.length && (f = f[0], c && ("usedropdowns" == c && 1 == f.FilterItemState) && (e = !1, SetDropDownSelectedElementForSprcificationFilters(g, a)), $(a).attr("class", (new FiltersManager).getFilterItemClassBasedOnState(f.FilterItemState, $(a).attr("class")))) }); c && ("usedropdowns" == c && !0 == e) && (h = $(a).find(".allFilterDropDownOptions")[0], SetDropDownSelectedElementForSprcificationFilters(g, h)) } }) } function SetDropDownSelectedElementForSprcificationFilters(b, c) { var d = $("#specificationFiltersDropDown" + b), a = $(c).parent(), g = d.get(0); a.siblings().removeClass("selected"); a.addClass("selected"); g.selectedLiElement = a; d.find("p").text($(c).text()) } function FilterProductsBySpecificationAttributeOption(b) { b = $(b.currentTarget); var c = b.parents("div[data-optionsGroupId]"); (new FiltersManager).requestProductsForSelectedFilters(c, b) };