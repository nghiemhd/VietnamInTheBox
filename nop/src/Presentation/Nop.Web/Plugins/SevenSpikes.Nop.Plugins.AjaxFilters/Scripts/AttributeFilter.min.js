/*
* Copyright 2013 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { $(".attributeFilterPanel7Spikes .filtersGroupPanel a[data-option-ids]").each(function () { var a = new AttributeFiltersManager; $(this).click(a.filterProductsByProductAttributeOption) }) }); function AttributeFiltersManager() { } AttributeFiltersManager.prototype.filterProductsByProductAttributeOption = FilterProductsByProductAttributeOption; AttributeFiltersManager.prototype.buildAttributeFiltersModel = BuildAttributeFiltersModel; AttributeFiltersManager.prototype.refreshAttributeFilters = RefreshAttributeFilters; FiltersManager.prototype.buildAttributeFiltersModel = (new AttributeFiltersManager).buildAttributeFiltersModel; FiltersManager.prototype.refreshAttributeFilters = (new AttributeFiltersManager).refreshAttributeFilters; function BuildAttributeFiltersModel(a, b, d) { var c = {}; c.CategoryId = a; c.ManufacturerId = b; c.AttributeFilterGroups = []; $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (b, a) { var k = $(a).attr("data-optionsGroupId"), e = {}; e.Id = k; void 0 != d && d.get(0) == a && (e.IsMain = !0, c.Priority = 1); e.FilterItems = []; $(a).find("a[data-option-ids]").each(function (a, b) { var c = $(b).text(), c = $.trim(c), d = $(b).attr("data-option-ids"), f = $(b).attr("class"), j = {}, d = d.split(","); j.Name = c; j.ProductVariantAttributeIds = d; j.FilterItemState = (new FiltersManager).getFilterItemStateBasedOnItemClass(f, j.FilterItemState); e.FilterItems.push(j) }); c.AttributeFilterGroups.push(e) }); return c } function RefreshAttributeFilters(a, b) { $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (d, c) { var h = $(c).attr("data-optionsGroupId"), g = $.grep(a.AttributeFilterGroups, function (b) { return b.Id == h }); if (0 != g.length) { var k = g[0]; if (b && "usedropdowns" == b) var e = !0; $(c).find("a[data-option-ids]").each(function (c, a) { var d = $(a).text(), g = $.trim(d), d = $(a).attr("class"), f = $.grep(k.FilterItems, function (a) { return a.Name == g }); 0 != f.length && (f = f[0], b && (1 == f.FilterItemState && "usedropdowns" == b) && (e = !1, SetDropDownSelectedElementForAttributeFilters(h, a)), $(a).attr("class", (new FiltersManager).getFilterItemClassBasedOnState(f.FilterItemState, d))) }); b && ("usedropdowns" == b && !0 == e) && (g = $(c).find(".allFilterDropDownOptions")[0], SetDropDownSelectedElementForAttributeFilters(h, g)) } }) } function SetDropDownSelectedElementForAttributeFilters(a, b) { var d = $("#attributeFiltersDropDown" + a), c = $(b).parent(), h = d.get(0); c.siblings().removeClass("selected"); c.addClass("selected"); h.selectedLiElement = c; d.find("p").text($(b).text()) } function FilterProductsByProductAttributeOption(a) { a = $(a.currentTarget); var b = a.parents("div[data-optionsGroupId]"); (new FiltersManager).requestProductsForSelectedFilters(b, a) };